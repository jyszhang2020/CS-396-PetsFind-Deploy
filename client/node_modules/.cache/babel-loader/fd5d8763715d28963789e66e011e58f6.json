{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'../styles/ListPet.css';import{Form,Input,TextArea,Button,Select}from'semantic-ui-react';import{speciesOption,genderOption}from'./DropdownOptions';import{catBreedOption,dogBreedOption,locationOption}from'./DropdownOptions';import{storage}from'../firebase/firebase';import history from'./history';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ListPet=/*#__PURE__*/function(_Component){_inherits(ListPet,_Component);var _super=_createSuper(ListPet);function ListPet(props){var _this;_classCallCheck(this,ListPet);_this=_super.call(this,props);_this.handleChange=function(value,state){var _this$setState;_this.setState((_this$setState={},_defineProperty(_this$setState,state,value),_defineProperty(_this$setState,state+\"_error\",false),_this$setState));};_this.handleChangeImage=function(e){_this.setState({image:e.target.files[0]});};_this.isDOBValid=function(){var regEx=/^\\d{4}-\\d{2}-\\d{2}$/;if(!_this.state.dob.match(regEx))return false;// Invalid format\nvar d=new Date(_this.state.dob);var dNum=d.getTime();if(!dNum&&dNum!==0)return false;// NaN value, Invalid date\nreturn d.toISOString().slice(0,10)===_this.state.dob;};_this.isPriceValid=function(){return!isNaN(_this.state.price)&&!isNaN(parseInt(_this.state.price));};_this.isContactValid=function(){var valid=true;if(_this.state.contact_phone.length!==10){valid=false;}for(var i=0;i<_this.state.contact_phone.length;i++){if(isNaN(_this.state.contact_phone[i])||isNaN(parseInt(_this.state.contact_phone[i]))){valid=false;}}return valid;};_this.validateForm=function(){var err=false;if(_this.state.name===''){_this.setState({name_error:true});err=true;}if(_this.state.species===''){_this.setState({species_error:true});err=true;}if(_this.state.sex===''){_this.setState({sex_error:true});err=true;}if(_this.state.dob===''||!_this.isDOBValid()){_this.setState({dob_error:true});err=true;}if(_this.state.price===''||!_this.isPriceValid()){_this.setState({price_error:true});err=true;}if(_this.state.detail===''){_this.setState({detail_error:true});err=true;}if(_this.state.contact_phone===''||!_this.isContactValid()){_this.setState({contact_phone_error:true});err=true;}if(_this.state.location===''){_this.setState({location_error:true});err=true;}if(_this.state.term_condition===false){_this.setState({term_condition_error:true});err=true;}return!err;};_this.handleSubmit=function(e){e.preventDefault();if(_this.validateForm()){var uploadTask=storage.ref(\"/images/\".concat(_this.state.name,\"_\").concat(_this.state.contact_phone)).put(_this.state.image);uploadTask.on('state_changed',function(snapShot){//takes a snap shot of the process as it is happening\nconsole.log(snapShot);},function(err){//catches the errors\nconsole.log(err);},function(){// gets the functions from storage refences the image storage in firebase by the children\n// gets the download url then sets the image from firebase as the value for the imgUrl key:\nstorage.ref('images').child(\"\".concat(_this.state.name,\"_\").concat(_this.state.contact_phone)).getDownloadURL().then(function(fireBaseUrl){fetch('http://localhost:8081/listpet',{method:'POST',body:JSON.stringify({species:_this.state.species,breed:_this.state.breed,name:_this.state.name,sex:_this.state.sex,dob:_this.state.dob,price:_this.state.price,contact_phone:_this.state.contact_phone,detail:_this.state.detail,image_url:fireBaseUrl,location:_this.state.location}),headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'POST, GET, OPTIONS, PUT, DELETE'}}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var pet;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(response.status===201)){_context.next=9;break;}_context.next=3;return response.json();case 3:pet=_context.sent;console.log(pet);localStorage.setItem(\"selectedPetID\",pet._id);history.push('/allpets/'+pet._id);_context.next=10;break;case 9:alert(\"Submit failed\");case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){return console.log(err);});});});}};_this.getBreedOptions=function(){if(_this.state.species===\"Cat\"){return catBreedOption;}else if(_this.state.species===\"Dog\"){return dogBreedOption;}return[];};_this.state={species:'',breed:'',name:'',sex:'',dob:'',price:'',contact_phone:'',detail:'',image:'',location:'',term_condition:false,name_error:false,species_error:false,sex_error:false,dob_error:false,price_error:false,detail_error:false,contact_phone_error:false,location_error:false,term_condition_error:false};return _this;}_createClass(ListPet,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{id:\"smallest-page-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"Having a pet to sell? List your pet here!\"}),/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{widths:\"equal\",children:[/*#__PURE__*/_jsx(Form.Field,{control:Input,label:\"Pet Name\",onChange:function onChange(event,_ref2){var value=_ref2.value;return _this2.handleChange(value,\"name\");},placeholder:\"e.g. Max\",error:this.state.name_error}),/*#__PURE__*/_jsx(Form.Field,{control:Select,label:\"Pet Species\",options:speciesOption,onChange:function onChange(event,_ref3){var value=_ref3.value;return _this2.handleChange(value,\"species\");},placeholder:\"e.g. Cat\",error:this.state.species_error}),/*#__PURE__*/_jsx(Form.Field,{control:Select,options:this.getBreedOptions(),label:\"Pet Breed\",onChange:function onChange(event,_ref4){var value=_ref4.value;return _this2.handleChange(value,\"breed\");},placeholder:\"e.g. Ragdoll\",search:true})]}),/*#__PURE__*/_jsxs(Form.Group,{widths:\"equal\",children:[/*#__PURE__*/_jsx(Form.Field,{control:Select,label:\"Pet Sex\",options:genderOption,onChange:function onChange(event,_ref5){var value=_ref5.value;return _this2.handleChange(value,\"sex\");},placeholder:\"e.g. Male\",error:this.state.sex_error}),/*#__PURE__*/_jsx(Form.Field,{control:Input,label:\"Pet DOB (YYYY-MM-DD)\",onChange:function onChange(event,_ref6){var value=_ref6.value;return _this2.handleChange(value,\"dob\");},placeholder:\"e.g. 2021-02-03\",error:this.state.dob_error}),/*#__PURE__*/_jsx(Form.Field,{control:Input,label:\"Pet Price ($)\",onChange:function onChange(event,_ref7){var value=_ref7.value;return _this2.handleChange(value,\"price\");},placeholder:\"e.g. 1500\",error:this.state.price_error})]}),/*#__PURE__*/_jsx(Form.Field,{control:TextArea,label:\"Details about the pet\",onChange:function onChange(event,_ref8){var value=_ref8.value;return _this2.handleChange(value,\"detail\");},placeholder:\"e.g. temperament, parents...\",error:this.state.detail_error}),/*#__PURE__*/_jsxs(Form.Group,{widths:\"equal\",children:[/*#__PURE__*/_jsx(Form.Field,{control:Input,label:\"Contact Number\",onChange:function onChange(event,_ref9){var value=_ref9.value;return _this2.handleChange(value,\"contact_phone\");},placeholder:\"e.g. 2179792367\",error:this.state.contact_phone_error}),/*#__PURE__*/_jsx(Form.Field,{control:Select,label:\"Location\",options:locationOption,onChange:function onChange(event,_ref10){var value=_ref10.value;return _this2.handleChange(value,\"location\");},search:true,placeholder:\"e.g. Illinois\",error:this.state.location_error})]}),/*#__PURE__*/_jsx(Form.Field,{label:\"Image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",id:\"input-file\",onChange:this.handleChangeImage}),/*#__PURE__*/_jsx(Form.Checkbox,{label:\"I agree to the Terms and Conditions\",onChange:function onChange(event,_ref11){var checked=_ref11.checked;return _this2.handleChange(checked,\"term_condition\");},error:this.state.term_condition_error}),/*#__PURE__*/_jsx(Form.Field,{id:\"list-pet-submit-button\",control:Button,content:\"Submit\",onClick:this.handleSubmit})]})]});}}]);return ListPet;}(Component);export default ListPet;","map":{"version":3,"sources":["/Users/jerry/Desktop/CS396-PetsFinder/client/src/component/ListPet.js"],"names":["React","Component","Form","Input","TextArea","Button","Select","speciesOption","genderOption","catBreedOption","dogBreedOption","locationOption","storage","history","ListPet","props","handleChange","value","state","setState","handleChangeImage","e","image","target","files","isDOBValid","regEx","dob","match","d","Date","dNum","getTime","toISOString","slice","isPriceValid","isNaN","price","parseInt","isContactValid","valid","contact_phone","length","i","validateForm","err","name","name_error","species","species_error","sex","sex_error","dob_error","price_error","detail","detail_error","contact_phone_error","location","location_error","term_condition","term_condition_error","handleSubmit","preventDefault","uploadTask","ref","put","on","snapShot","console","log","child","getDownloadURL","then","fireBaseUrl","fetch","method","body","JSON","stringify","breed","image_url","headers","response","status","json","pet","localStorage","setItem","_id","push","alert","catch","getBreedOptions","event","checked"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport '../styles/ListPet.css';\nimport { Form, Input, TextArea, Button, Select } from 'semantic-ui-react'\nimport {speciesOption, genderOption} from './DropdownOptions';\nimport {catBreedOption, dogBreedOption, locationOption} from './DropdownOptions';\nimport {storage} from '../firebase/firebase'\nimport history from './history';\n\nclass ListPet extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            species: '',\n            breed: '',\n            name: '',\n            sex: '',\n            dob: '',\n            price: '',\n            contact_phone: '',\n            detail: '',\n            image: '',\n            location: '',\n            \n            term_condition: false,\n            name_error: false,\n            species_error: false,\n            sex_error: false,\n            dob_error: false,\n            price_error: false,\n            detail_error: false,\n            contact_phone_error: false,\n            location_error: false,\n            term_condition_error: false,\n        }\n    }\n\n    handleChange = (value, state) => {\n        this.setState({\n            [state]: value,\n            [state + \"_error\"]: false,\n        })\n    }\n\n    handleChangeImage = e => {\n        this.setState({\n            image: e.target.files[0]\n        })\n    }\n\n    isDOBValid = () => {\n        var regEx = /^\\d{4}-\\d{2}-\\d{2}$/;\n        if(!this.state.dob.match(regEx)) return false;  // Invalid format\n        var d = new Date(this.state.dob);\n        var dNum = d.getTime();\n        if(!dNum && dNum !== 0) return false; // NaN value, Invalid date\n        return d.toISOString().slice(0,10) === this.state.dob;\n    }\n\n    isPriceValid = () => {\n        return !isNaN(this.state.price) && !isNaN(parseInt(this.state.price))\n    }\n\n    isContactValid = () => {\n        let valid = true\n\n        if (this.state.contact_phone.length !== 10) {\n            valid = false\n        }\n\n        for (var i = 0; i < this.state.contact_phone.length; i++) {\n            if (isNaN(this.state.contact_phone[i]) || isNaN(parseInt(this.state.contact_phone[i]))) {\n                valid = false\n            }\n        }\n         \n\n        return valid\n    }\n\n    validateForm = () => {\n        let err = false\n\n        if (this.state.name === '') {\n            this.setState({name_error: true})\n            \n            err = true\n        }\n        if (this.state.species === '') {\n            this.setState({species_error: true})\n            \n            err = true\n        }\n        if (this.state.sex === '') {\n            this.setState({sex_error: true})\n            \n            err = true\n        }\n        if (this.state.dob === '' || !this.isDOBValid()) {\n            this.setState({dob_error: true})\n            \n            err = true\n        }\n        if (this.state.price === '' || !this.isPriceValid()) {\n            this.setState({price_error: true})\n            \n            err = true\n        }\n        if (this.state.detail === '') {\n            this.setState({detail_error: true})\n            \n            err = true\n        }\n        if (this.state.contact_phone === '' || !this.isContactValid()) {\n            this.setState({contact_phone_error: true})\n            \n            err = true\n        }\n        if (this.state.location === '') {\n            this.setState({location_error: true})\n            \n            err = true\n        }\n        if (this.state.term_condition === false) {\n            this.setState({\n                term_condition_error: true\n            })\n\n            err = true\n        }\n\n        return !err\n    }\n\n    handleSubmit = (e) => {\n        e.preventDefault()\n\n        if (this.validateForm()) {\n            const uploadTask = storage.ref(`/images/${this.state.name}_${this.state.contact_phone}`).put(this.state.image)\n            uploadTask.on('state_changed', \n                (snapShot) => {\n                    //takes a snap shot of the process as it is happening\n                    console.log(snapShot)\n                }, (err) => {\n                    //catches the errors\n                    console.log(err)\n                }, () => {\n                    // gets the functions from storage refences the image storage in firebase by the children\n                    // gets the download url then sets the image from firebase as the value for the imgUrl key:\n                    storage.ref('images').child(`${this.state.name}_${this.state.contact_phone}`).getDownloadURL()\n                    .then(fireBaseUrl => {\n                        fetch('http://localhost:8081/listpet', {\n                            method: 'POST',\n                            body: JSON.stringify({\n                                species: this.state.species,\n                                breed: this.state.breed,\n                                name: this.state.name,\n                                sex: this.state.sex,\n                                dob: this.state.dob,\n                                price: this.state.price,\n                                contact_phone: this.state.contact_phone,\n                                detail: this.state.detail,\n                                image_url: fireBaseUrl,\n                                location: this.state.location,\n                            }),\n                            headers: {\n                                'Content-Type': 'application/json',\n                                'Access-Control-Allow-Origin': '*',\n                                'Access-Control-Allow-Methods': 'POST, GET, OPTIONS, PUT, DELETE',\n                            }\n                        })\n                            .then(async response => {\n                                if (response.status === 201) {\n                                    let pet = await response.json()\n                                    console.log(pet)\n                                    localStorage.setItem(\"selectedPetID\", pet._id);\n                                    history.push('/allpets/' + pet._id)\n                                }\n                                else {\n                                    alert(\"Submit failed\")\n                                }\n                            })\n                            .catch((err) => console.log(err))\n                    })\n                })\n        }\n    }\n\n    getBreedOptions = () => {\n        if (this.state.species === \"Cat\") {\n            return catBreedOption\n        } else if (this.state.species === \"Dog\") {\n            return dogBreedOption\n        }\n\n        return []\n    }\n\n    render() {\n        return (\n            <div id=\"smallest-page-container\">\n                <h1 className=\"title\">\n                    Having a pet to sell? List your pet here!\n                </h1>\n                <Form>\n                    <Form.Group widths='equal'>\n                        <Form.Field\n                            control={Input}\n                            label='Pet Name'\n                            onChange={(event, {value}) => this.handleChange(value, \"name\")}\n                            placeholder='e.g. Max'\n                            error={this.state.name_error}\n                        />\n                        <Form.Field\n                            control={Select}\n                            label='Pet Species'\n                            options={speciesOption}\n                            onChange={(event, {value}) => this.handleChange(value, \"species\")}\n                            placeholder='e.g. Cat'\n                            error={this.state.species_error}\n                        />\n                        <Form.Field\n                            control={Select}\n                            options={this.getBreedOptions()}\n                            label='Pet Breed'\n                            onChange={(event, {value}) => this.handleChange(value, \"breed\")}\n                            placeholder='e.g. Ragdoll'\n                            search\n                        />\n                    </Form.Group>\n                    <Form.Group widths='equal'>\n                        <Form.Field\n                            control={Select}\n                            label='Pet Sex'\n                            options={genderOption}\n                            onChange={(event, {value}) => this.handleChange(value, \"sex\")}\n                            placeholder='e.g. Male'\n                            error={this.state.sex_error}\n                        />\n                        <Form.Field\n                            control={Input}\n                            label='Pet DOB (YYYY-MM-DD)'\n                            onChange={(event, {value}) => this.handleChange(value, \"dob\")}\n                            placeholder='e.g. 2021-02-03'\n                            error={this.state.dob_error}\n                        />\n                        <Form.Field\n                            control={Input}\n                            label='Pet Price ($)'\n                            onChange={(event, {value}) => this.handleChange(value, \"price\")}\n                            placeholder='e.g. 1500'\n                            error={this.state.price_error}\n                        />\n                    </Form.Group>\n                    <Form.Field\n                        control={TextArea}\n                        label='Details about the pet'\n                        onChange={(event, {value}) => this.handleChange(value, \"detail\")}\n                        placeholder='e.g. temperament, parents...'\n                        error={this.state.detail_error}\n                    />\n                    <Form.Group widths='equal'>\n                        <Form.Field\n                            control={Input}\n                            label='Contact Number'\n                            onChange={(event, {value}) => this.handleChange(value, \"contact_phone\")}\n                            placeholder='e.g. 2179792367'\n                            error={this.state.contact_phone_error}\n                        />\n                        <Form.Field\n                            control={Select}\n                            label='Location'\n                            options={locationOption}\n                            onChange={(event, {value}) => this.handleChange(value, \"location\")}\n                            search\n                            placeholder='e.g. Illinois'\n                            error={this.state.location_error}\n                        />\n                    </Form.Group>\n                    <Form.Field\n                        label='Image'\n                    />\n                    <input type=\"file\" name=\"file\" id=\"input-file\" onChange={this.handleChangeImage} />\n                    <Form.Checkbox\n                        label='I agree to the Terms and Conditions'\n                        onChange={(event, {checked}) => this.handleChange(checked, \"term_condition\")}\n                        error={this.state.term_condition_error}\n                    />\n                    <Form.Field\n                        id='list-pet-submit-button'\n                        control={Button}\n                        content='Submit'\n                        onClick={this.handleSubmit}\n                    />\n                </Form>\n            </div>\n        )\n    }\n}\n\nexport default ListPet;"]},"metadata":{},"sourceType":"module"}