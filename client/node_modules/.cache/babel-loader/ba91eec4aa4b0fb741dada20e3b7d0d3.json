{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _slicedToArray from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component}from'react';import Pet from'./Pet';import{Button,Radio,Dropdown}from\"semantic-ui-react\";import history from'./history';import CheckBox from'./CheckBox';import{sortOption}from'./DropdownOptions';import'../styles/Community.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var parseQueryParameter=function parseQueryParameter(q){if(q===\"\")return{};var qs=q.replace(\"?\",\"\").split(\"&\");var params={};qs.forEach(function(param){param=param.split(\"=\");if(param[1]!==\"\"){params[param[0]]=param[1].replaceAll(\"%20\",\" \");}});return params;};var joinQueryParameter=function joinQueryParameter(params){var res=\"?\";for(var _i=0,_Object$entries=Object.entries(params);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];res+=key+\"=\"+value+\"&\";}return res.slice(0,-1);};var Community=/*#__PURE__*/function(_Component){_inherits(Community,_Component);var _super=_createSuper(Community);function Community(props){var _this;_classCallCheck(this,Community);_this=_super.call(this,props);_this.fetchPets=function(params){fetch(\"http://localhost:8081/filterpet\",{method:'POST',body:JSON.stringify(params),headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'POST, GET, OPTIONS, PUT, DELETE'}}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return response.json();case 2:data=_context.sent;if(response.status===404){_this.setState({err:data.message});}else if(response.status===200){_this.state.ranges.map(function(range){var res=data.filter(function(pet){return pet.price>=range.min&&pet.price<range.max;});range.arr=res;});_this.setState({pets:data});_this.setState({curpets:data});}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){_this.setState({err:err.message});});};_this.handleSexChange=function(e,_ref2){var value=_ref2.value;_this.setState({sex:value});var params=parseQueryParameter(_this.props.location.search);params['sex']=value;_this.props.history.push(_this.props.location.pathname+joinQueryParameter(params));_this.fetchPets(params);};_this.uncheck=function(e){_this.setState({sex:''});var params=parseQueryParameter(_this.props.location.search);delete params['sex'];_this.props.history.push(_this.props.location.pathname+joinQueryParameter(params));_this.fetchPets(params);};_this.toggle=function(event){var ranges=_this.state.ranges;var queryRange=[];ranges.forEach(function(range){if(range.value===event.target.value){range.isChecked=event.target.checked;}if(range.isChecked){queryRange.push(range.min+\"-\"+range.max);}});_this.setState({ranges:ranges});var params=parseQueryParameter(_this.props.location.search);delete params['price'];if(queryRange.length!==0)params['price']=queryRange.join(\",\");_this.props.history.push(_this.props.location.pathname+joinQueryParameter(params));_this.fetchPets(params);};_this.handleSort=function(value){var array=_this.state.curpets;if(value===\"ascending\"){array.sort(function(a,b){return a.price>b.price?1:-1;});}else if(value===\"descending\"){array.sort(function(a,b){return a.price>b.price?-1:1;});}_this.setState({curpets:array});};_this.state={pets:[],curpets:[],sex:'',price:'',ranges:[{id:1,min:0,max:100,isChecked:false,value:\"Under $100.00\",arr:[]},{id:2,min:100,max:500,isChecked:false,value:\"$100.00 to $500.00\",arr:[]},{id:3,min:500,max:1000,isChecked:false,value:\"$500.00 to $1000.00\",arr:[]},{id:4,min:1000,max:1500,isChecked:false,value:\"$1000.00 to $1500.00\",arr:[]},{id:5,min:1500,max:3000,isChecked:false,value:\"$1500.00 to $3000.00\",arr:[]},{id:6,min:3000,max:1000000000,isChecked:false,value:\"Above $3000.00\",arr:[]}]};return _this;}_createClass(Community,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchPets([]);// fetch all pets\n}},{key:\"render\",value:function render(){var _this2=this;var pets=this.state.curpets;return/*#__PURE__*/_jsx(_Fragment,{children:pets.length===0?/*#__PURE__*/_jsx(\"div\",{id:\"smallest-page-container\",children:/*#__PURE__*/_jsx(\"div\",{class:\"search-result-container err\",children:\"Sorry, there is no matching pet available!\"})}):/*#__PURE__*/_jsx(\"div\",{id:\"smallest-page-container\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"search-result-container result\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Select the Price Range\"}),/*#__PURE__*/_jsx(\"div\",{className:\"price-checkbox\",children:this.state.ranges.map(function(range){return/*#__PURE__*/_jsx(CheckBox,{toggle:_this2.toggle,range:range});})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Choose the Sex\"}),/*#__PURE__*/_jsx(Radio,{label:\"Male\",name:\"radioGroup\",value:\"Male\",onChange:this.handleSexChange,checked:this.state.sex==='Male'}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Radio,{label:\"Female\",name:\"radioGroup\",value:\"Female\",onChange:this.handleSexChange,checked:this.state.sex==='Female'}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{onClick:this.uncheck,children:\"Clear Sex\"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Sort Price\"}),/*#__PURE__*/_jsx(Dropdown,{onChange:function onChange(e,_ref3){var value=_ref3.value;return _this2.handleSort(value);},placeholder:\"Sort\",selection:true,options:sortOption})]}),/*#__PURE__*/_jsx(\"div\",{id:\"search-result-section\",children:pets.map(function(pet){return/*#__PURE__*/_jsx(Pet,{pet:pet});})})]})})});}}]);return Community;}(Component);export default Community;","map":{"version":3,"sources":["/Users/jerry/Desktop/CS396-PetsFinder/client/src/component/Community.js"],"names":["React","Component","Pet","Button","Radio","Dropdown","history","CheckBox","sortOption","parseQueryParameter","q","qs","replace","split","params","forEach","param","replaceAll","joinQueryParameter","res","Object","entries","key","value","slice","Community","props","fetchPets","fetch","method","body","JSON","stringify","headers","then","response","json","data","status","setState","err","message","state","ranges","map","range","filter","pet","price","min","max","arr","pets","curpets","catch","handleSexChange","e","sex","location","search","push","pathname","uncheck","toggle","event","queryRange","target","isChecked","checked","length","join","handleSort","array","sort","a","b","id"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Pet from './Pet';\nimport { Button, Radio, Dropdown } from \"semantic-ui-react\";\nimport history from './history';\nimport CheckBox from './CheckBox';\nimport { sortOption } from './DropdownOptions';\n\nimport '../styles/Community.css';\n\nconst parseQueryParameter = q => {\n    if (q === \"\")\n        return {}\n\n    let qs = q.replace(\"?\", \"\").split(\"&\")\n    let params = {}\n\n    qs.forEach(param => {\n        param = param.split(\"=\")\n        \n        if (param[1] !== \"\") {\n            params[param[0]] = param[1].replaceAll(\"%20\", \" \")\n        }\n        \n    });\n\n    return params\n}\n\nconst joinQueryParameter = params => {\n    let res = \"?\"\n\n    for (let [key, value] of Object.entries(params)) {\n        res += key + \"=\" + value + \"&\"\n    }\n\n    return res.slice(0, -1)\n}\n\nclass Community extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            pets: [],\n            curpets: [],\n            sex: '',\n            price: '',\n            ranges: [\n                { id: 1, min: 0, max: 100, isChecked: false, value: \"Under $100.00\", arr: [] },\n                { id: 2, min: 100, max: 500, isChecked: false, value: \"$100.00 to $500.00\", arr: [] },\n                { id: 3, min: 500, max: 1000, isChecked: false, value: \"$500.00 to $1000.00\", arr: [] },\n                { id: 4, min: 1000, max: 1500, isChecked: false, value: \"$1000.00 to $1500.00\", arr: [] },\n                { id: 5, min: 1500, max: 3000, isChecked: false, value: \"$1500.00 to $3000.00\", arr: [] },\n                { id: 6, min: 3000, max: 1000000000, isChecked: false, value: \"Above $3000.00\", arr: [] }\n            ]\n        }\n    }\n\n    componentDidMount() {\n        this.fetchPets([]) // fetch all pets\n    }\n\n    fetchPets = (params) => {\n        fetch(\"http://localhost:8081/filterpet\", {\n            method: 'POST',\n            body: JSON.stringify(params),\n            headers: {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*',\n                'Access-Control-Allow-Methods': 'POST, GET, OPTIONS, PUT, DELETE',\n            }\n        })\n        .then(async response => {\n            let data = await response.json()\n            if (response.status === 404) {\n                this.setState({err: data.message});\n            } else if (response.status === 200) {\n                this.state.ranges.map((range) => {\n                    const res = data.filter(pet => pet.price >= range.min && pet.price < range.max);\n                    range.arr = res;\n                })\n                this.setState({pets: data});\n                this.setState({curpets: data});\n            }\n        })\n        .catch(err => {\n            this.setState({err: err.message});\n        })\n    }\n\n    handleSexChange = (e, { value }) => {\n        this.setState({sex: value});\n        let params = parseQueryParameter(this.props.location.search)\n        params['sex'] = value\n        this.props.history.push(this.props.location.pathname + joinQueryParameter(params))\n        this.fetchPets(params)\n    }\n\n    uncheck = (e) => {\n        this.setState({sex: ''});\n        let params = parseQueryParameter(this.props.location.search)\n        delete params['sex'];\n        this.props.history.push(this.props.location.pathname + joinQueryParameter(params))\n        this.fetchPets(params)\n    }\n\n    toggle = (event) => {\n        let ranges = this.state.ranges\n        let queryRange = []\n        ranges.forEach(range => {\n            if (range.value === event.target.value) {\n                range.isChecked =  event.target.checked\n            }\n            if (range.isChecked) {\n                queryRange.push(range.min + \"-\" + range.max)\n            }\n        })\n        this.setState({ranges: ranges})\n\n        let params = parseQueryParameter(this.props.location.search)\n        delete params['price']\n        if (queryRange.length !== 0)\n            params['price'] = queryRange.join(\",\")\n        this.props.history.push(this.props.location.pathname + joinQueryParameter(params))\n        this.fetchPets(params)\n    }\n    \n    handleSort = (value) => {\n        let array = this.state.curpets;\n        if (value === \"ascending\") {\n            array.sort((a, b) => a.price > b.price ? 1 : -1);\n        } else if (value === \"descending\") {\n            array.sort((a, b) => a.price > b.price ? -1 : 1);\n        }\n        this.setState({curpets: array});\n    }\n\n    render() {\n        let pets = this.state.curpets;\n        \n        return (\n            <>\n                {\n                    pets.length === 0 ? (\n                        <div id=\"smallest-page-container\">\n                            <div class=\"search-result-container err\">Sorry, there is no matching pet available!</div>\n                        </div>\n                    ) : (\n                        <div id=\"smallest-page-container\">\n                            <div class=\"search-result-container result\">\n                                <div id=\"filter-section\">\n                                    <h3>Select the Price Range</h3>\n                                    <div className=\"price-checkbox\">\n                                        {\n                                            this.state.ranges.map((range) => {\n                                                return (<CheckBox toggle={this.toggle} range={range}/>)\n                                            })\n                                        }\n                                    </div>\n\n                                    <h3>Choose the Sex</h3>\n                                    <Radio\n                                        label='Male'\n                                        name='radioGroup'\n                                        value='Male'\n                                        onChange={this.handleSexChange}\n                                        checked={this.state.sex === 'Male'}\n                                    /><br/>\n                                    <Radio\n                                        label='Female'\n                                        name='radioGroup'\n                                        value='Female'\n                                        onChange={this.handleSexChange}\n                                        checked={this.state.sex === 'Female'}\n                                    /><br/><br/>\n                                    <div>\n                                        <Button onClick={this.uncheck}>Clear Sex</Button>\n                                    </div>\n                                    <h3>Sort Price</h3>\n                                    <Dropdown\n                                            onChange={(e, {value}) => this.handleSort(value)}\n                                            placeholder=\"Sort\"\n                                            selection\n                                            options={sortOption}\n                                        />\n                                </div>\n                                <div id=\"search-result-section\">\n                                    {pets.map((pet) => (\n                                        <Pet pet={pet}/>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    )\n                }\n            </>\n        )\n    }\n}\n\nexport default Community;"]},"metadata":{},"sourceType":"module"}