{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _slicedToArray from\"/Users/jerry/Desktop/CS396-PetsFinder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component}from'react';import'../styles/SearchResult.css';import{Button,Dropdown,Radio}from\"semantic-ui-react\";import Pet from'./Pet';import history from'./history';import CheckBox from'./CheckBox';import{sortOption}from'./DropdownOptions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var parseQueryParameter=function parseQueryParameter(q){var qs=q.replace(\"?\",\"\").split(\"&\");var params={};qs.forEach(function(param){param=param.split(\"=\");if(param[1]!==\"\"){params[param[0]]=param[1].replaceAll(\"%20\",\" \");}});return params;};var joinQueryParameter=function joinQueryParameter(params){var res=\"?\";for(var _i=0,_Object$entries=Object.entries(params);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];res+=key+\"=\"+value+\"&\";}return res.slice(0,-1);};var SearchResult=/*#__PURE__*/function(_Component){_inherits(SearchResult,_Component);var _super=_createSuper(SearchResult);function SearchResult(){var _this;_classCallCheck(this,SearchResult);_this=_super.call(this);_this.fetchPets=function(params){fetch(\"http://localhost:8081/filterpet\",{method:'POST',body:JSON.stringify(params),headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'POST, GET, OPTIONS, PUT, DELETE'}}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return response.json();case 2:data=_context.sent;if(response.status===404){_this.setState({err:data.message});}else if(response.status===200){_this.state.ranges.map(function(range){var res=data.filter(function(pet){return pet.price>=range.min&&pet.price<range.max;});range.arr=res;});_this.setState({pets:data});_this.setState({curpets:data});}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){_this.setState({err:err.message});});};_this.handleSexChange=function(e,_ref2){var value=_ref2.value;_this.setState({sex:value});var params=parseQueryParameter(_this.props.location.search);params['sex']=value;_this.props.history.push(_this.props.location.pathname+joinQueryParameter(params));_this.fetchPets(params);};_this.uncheck=function(e){_this.setState({sex:''});var params=parseQueryParameter(_this.props.location.search);delete params['sex'];_this.props.history.push(_this.props.location.pathname+joinQueryParameter(params));_this.fetchPets(params);};_this.toggle=function(event){var ranges=_this.state.ranges;var queryRange=[];ranges.forEach(function(range){if(range.value===event.target.value){range.isChecked=event.target.checked;}if(range.isChecked){queryRange.push(range.min+\"-\"+range.max);}});_this.setState({ranges:ranges});var params=parseQueryParameter(_this.props.location.search);delete params['price'];if(queryRange.length!==0)params['price']=queryRange.join(\",\");_this.props.history.push(_this.props.location.pathname+joinQueryParameter(params));_this.fetchPets(params);};_this.handleSort=function(value){var array=_this.state.curpets;if(value===\"ascending\"){array.sort(function(a,b){return a.price>b.price?1:-1;});}else if(value===\"descending\"){array.sort(function(a,b){return a.price>b.price?-1:1;});}_this.setState({curpets:array});};_this.state={pets:[],curpets:[],sex:'',price:'',species:'',breed:'',location:'',ranges:[{id:1,min:0,max:100,isChecked:false,value:\"Under $100.00\",arr:[]},{id:2,min:100,max:500,isChecked:false,value:\"$100.00 to $500.00\",arr:[]},{id:3,min:500,max:1000,isChecked:false,value:\"$500.00 to $1000.00\",arr:[]},{id:4,min:1000,max:1500,isChecked:false,value:\"$1000.00 to $1500.00\",arr:[]},{id:5,min:1500,max:3000,isChecked:false,value:\"$1500.00 to $3000.00\",arr:[]},{id:6,min:3000,max:9999,isChecked:false,value:\"Above $3000.00\",arr:[]}]};return _this;}_createClass(SearchResult,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.props.location.state===undefined){console.log(\"search from the home page\");var params=parseQueryParameter(this.props.location.search);if(params.species!==undefined){this.state.species=params.species;}if(params.breed!==undefined){this.state.breed=params.breed;}if(params.location!==undefined){this.state.location=params.location;}if(params.sex!==undefined){this.state.sex=params.sex;}if(params.price!==undefined){var queryPrice=params.price.split(\",\");var ranges=this.state.ranges;for(var i=0;i<queryPrice.length;i++){var _queryPrice$i$split=queryPrice[i].split(\"-\"),_queryPrice$i$split2=_slicedToArray(_queryPrice$i$split,2),currMin=_queryPrice$i$split2[0],currMax=_queryPrice$i$split2[1];for(var j=0;j<ranges.length;j++){if(parseInt(currMin)===ranges[j].min&&parseInt(currMax)===ranges[j].max){ranges[j].isChecked=true;}}}console.log(ranges);this.setState({ranges:ranges});}this.fetchPets(params);}else{console.log(\"passed state are: \",this.props.location.state);var _params=parseQueryParameter(this.props.location.search);console.log(\"here is the params\",_params);if(_params.species!==undefined){this.state.species=_params.species;}if(_params.breed!==undefined){this.state.breed=_params.breed;}if(_params.location!==undefined){this.state.location=_params.location;}if(_params.sex!==undefined){this.state.sex=_params.sex;}this.setState({pets:this.props.location.state.allpets});this.setState({curpets:this.props.location.state.curpets});this.setState({ranges:this.props.location.state.ranges});console.log(\"allpets are: \",this.props.location.state.allpets);console.log(\"curpets are: \",this.props.location.state.curpets);console.log(\"ranges are: \",this.props.location.state.ranges);}}},{key:\"render\",value:function render(){var _this2=this;var pets=this.state.curpets;return/*#__PURE__*/_jsx(_Fragment,{children:pets.length===0?/*#__PURE__*/_jsx(\"div\",{id:\"smallest-page-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"search-result-container err\",children:\"Sorry, there is no matching pet available!\"})}):/*#__PURE__*/_jsx(\"div\",{id:\"smallest-page-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-result-container result\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"filter-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Select the Price Range\"}),/*#__PURE__*/_jsx(\"div\",{className:\"price-checkbox\",children:this.state.ranges.map(function(range){return/*#__PURE__*/_jsx(CheckBox,{toggle:_this2.toggle,range:range});})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Choose the Sex\"}),/*#__PURE__*/_jsx(Radio,{label:\"Male\",name:\"radioGroup\",value:\"Male\",onChange:this.handleSexChange,checked:this.state.sex==='Male'}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Radio,{label:\"Female\",name:\"radioGroup\",value:\"Female\",onChange:this.handleSexChange,checked:this.state.sex==='Female'}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{onClick:this.uncheck,children:\" Clear Sex \"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Sort Price\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Dropdown,{onChange:function onChange(e,_ref3){var value=_ref3.value;return _this2.handleSort(value);},placeholder:\"Sort\",selection:true,options:sortOption})})]}),/*#__PURE__*/_jsx(\"div\",{id:\"search-result-section\",children:pets.map(function(pet){return/*#__PURE__*/_jsx(Pet,{pet:pet});})})]})})});}}]);return SearchResult;}(Component);export default SearchResult;","map":{"version":3,"sources":["/Users/jerry/Desktop/CS396-PetsFinder/client/src/component/SearchResult.js"],"names":["React","Component","Button","Dropdown","Radio","Pet","history","CheckBox","sortOption","parseQueryParameter","q","qs","replace","split","params","forEach","param","replaceAll","joinQueryParameter","res","Object","entries","key","value","slice","SearchResult","fetchPets","fetch","method","body","JSON","stringify","headers","then","response","json","data","status","setState","err","message","state","ranges","map","range","filter","pet","price","min","max","arr","pets","curpets","catch","handleSexChange","e","sex","props","location","search","push","pathname","uncheck","toggle","event","queryRange","target","isChecked","checked","length","join","handleSort","array","sort","a","b","species","breed","id","undefined","console","log","queryPrice","i","currMin","currMax","j","parseInt","allpets"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport '../styles/SearchResult.css'\nimport { Button, Dropdown, Radio } from \"semantic-ui-react\";\nimport Pet from './Pet';\nimport history from './history';\nimport CheckBox from './CheckBox';\nimport { sortOption } from './DropdownOptions';\n\n\nconst parseQueryParameter = q => {\n    let qs = q.replace(\"?\", \"\").split(\"&\")\n    let params = {}\n\n    qs.forEach(param => {\n        param = param.split(\"=\")\n        \n        if (param[1] !== \"\") {\n            params[param[0]] = param[1].replaceAll(\"%20\", \" \")\n        }\n        \n    });\n\n    return params\n}\n\nconst joinQueryParameter = params => {\n    let res = \"?\"\n\n    for (let [key, value] of Object.entries(params)) {\n        res += key + \"=\" + value + \"&\"\n    }\n\n    return res.slice(0, -1)\n}\n\nclass SearchResult extends Component {\n    constructor() {\n        super();\n        this.state = {\n            pets: [],\n            curpets: [],\n            sex: '',\n            price: '',\n            species: '',\n            breed: '',\n            location: '',\n            ranges: [\n                { id: 1, min: 0, max: 100, isChecked: false, value: \"Under $100.00\", arr: [] },\n                { id: 2, min: 100, max: 500, isChecked: false, value: \"$100.00 to $500.00\", arr: [] },\n                { id: 3, min: 500, max: 1000, isChecked: false, value: \"$500.00 to $1000.00\", arr: [] },\n                { id: 4, min: 1000, max: 1500, isChecked: false, value: \"$1000.00 to $1500.00\", arr: [] },\n                { id: 5, min: 1500, max: 3000, isChecked: false, value: \"$1500.00 to $3000.00\", arr: [] },\n                { id: 6, min: 3000, max: 9999, isChecked: false, value: \"Above $3000.00\", arr: [] }\n            ]\n        }\n    }\n    \n    componentDidMount() {\n        if (this.props.location.state === undefined) {\n            console.log(\"search from the home page\");\n\n            let params = parseQueryParameter(this.props.location.search)\n \n            if (params.species !== undefined) {\n                this.state.species = params.species;\n            }\n            if (params.breed !== undefined) {\n                this.state.breed = params.breed;\n            }\n            if (params.location !== undefined) {\n                this.state.location = params.location;\n            }\n            if (params.sex !== undefined) {\n                this.state.sex = params.sex;\n            }\n            if (params.price !== undefined) {\n                let queryPrice = params.price.split(\",\")\n                let ranges = this.state.ranges\n\n                for (let i = 0; i < queryPrice.length; i++) {\n                    let [currMin, currMax] = queryPrice[i].split(\"-\")\n\n                    for (let j = 0; j < ranges.length; j++) {\n                        if (parseInt(currMin) === ranges[j].min && parseInt(currMax) === ranges[j].max) {\n                            ranges[j].isChecked = true\n                        }\n                    }\n                }\n\n                console.log(ranges)\n                \n                this.setState({ranges: ranges})\n            }\n            \n            this.fetchPets(params)\n\n        } else {\n            console.log(\"passed state are: \", this.props.location.state);\n            let params = parseQueryParameter(this.props.location.search)\n            console.log(\"here is the params\", params);\n            if (params.species !== undefined) {\n                this.state.species = params.species;\n            }\n            if (params.breed !== undefined) {\n                this.state.breed = params.breed;\n            }\n            if (params.location !== undefined) {\n                this.state.location = params.location;\n            }\n            if (params.sex !== undefined) {\n                this.state.sex = params.sex;\n            }\n            this.setState({pets: this.props.location.state.allpets})\n            this.setState({curpets: this.props.location.state.curpets});\n            this.setState({ranges: this.props.location.state.ranges});\n            console.log(\"allpets are: \", this.props.location.state.allpets);\n            console.log(\"curpets are: \", this.props.location.state.curpets);\n            console.log(\"ranges are: \", this.props.location.state.ranges);\n        }\n    }\n\n    fetchPets = (params) => {\n        fetch(\"http://localhost:8081/filterpet\", {\n            method: 'POST',\n            body: JSON.stringify(params),\n            headers: {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*',\n                'Access-Control-Allow-Methods': 'POST, GET, OPTIONS, PUT, DELETE',\n            }\n        })\n        .then(async response => {\n            let data = await response.json()\n            if (response.status === 404) {\n                this.setState({err: data.message});\n            } else if (response.status === 200) {\n                this.state.ranges.map((range) => {\n                    const res = data.filter(pet => pet.price >= range.min && pet.price < range.max);\n                    range.arr = res;\n                })\n                this.setState({pets: data});\n                this.setState({curpets: data});\n            }\n        })\n        .catch(err => {\n            this.setState({err: err.message});\n        })\n    }\n\n    handleSexChange = (e, { value }) => {\n        this.setState({sex: value});\n        let params = parseQueryParameter(this.props.location.search)\n        params['sex'] = value\n        this.props.history.push(this.props.location.pathname + joinQueryParameter(params))\n        this.fetchPets(params)\n    }\n\n    uncheck = (e) => {\n        this.setState({sex: ''});\n        let params = parseQueryParameter(this.props.location.search)\n        delete params['sex'];\n        this.props.history.push(this.props.location.pathname + joinQueryParameter(params))\n        this.fetchPets(params)\n    }\n\n    toggle = (event) => {\n        let ranges = this.state.ranges\n        let queryRange = []\n        ranges.forEach(range => {\n            if (range.value === event.target.value) {\n                range.isChecked =  event.target.checked\n            }\n            if (range.isChecked) {\n                queryRange.push(range.min + \"-\" + range.max)\n            }\n        })\n        this.setState({ranges: ranges})\n\n        let params = parseQueryParameter(this.props.location.search)\n        delete params['price']\n        if (queryRange.length !== 0)\n            params['price'] = queryRange.join(\",\")\n        this.props.history.push(this.props.location.pathname + joinQueryParameter(params))\n        this.fetchPets(params)\n    }\n\n    handleSort = (value) => {\n        let array = this.state.curpets;\n        if (value === \"ascending\") {\n            array.sort((a, b) => a.price > b.price ? 1 : -1);\n        } else if (value === \"descending\") {\n            array.sort((a, b) => a.price > b.price ? -1 : 1);\n        }\n        this.setState({curpets: array});\n    }\n\n    render() {\n        let pets = this.state.curpets;\n        return (\n            <>\n                {\n                    pets.length === 0 ? (\n                        <div id=\"smallest-page-container\">\n                            <div className=\"search-result-container err\">Sorry, there is no matching pet available!</div>\n                        </div>\n                    ) : (\n                        <div id=\"smallest-page-container\">\n                            <div className=\"search-result-container result\">\n                                <div id=\"filter-section\">\n                                    <h3>Select the Price Range</h3>\n                                    <div className=\"price-checkbox\">\n                                        {\n                                            this.state.ranges.map((range) => {\n                                                return (<CheckBox toggle={this.toggle} range={range}/>)\n                                            })\n                                        }\n                                    </div>\n\n                                    <h3>Choose the Sex</h3>\n                                    <Radio\n                                        label='Male'\n                                        name='radioGroup'\n                                        value='Male'\n                                        onChange={this.handleSexChange}\n                                        checked={this.state.sex === 'Male'}\n                                    /><br/>\n                                    <Radio\n                                        label='Female'\n                                        name='radioGroup'\n                                        value='Female'\n                                        onChange={this.handleSexChange}\n                                        checked={this.state.sex === 'Female'}\n                                    /><br/><br/>\n                                    <div>\n                                        <Button onClick={this.uncheck}> Clear Sex </Button>\n                                    </div>\n                                    <h3>Sort Price</h3>\n                                    <div>\n                                        <Dropdown\n                                            onChange={(e, {value}) => this.handleSort(value)}\n                                            placeholder=\"Sort\"\n                                            selection\n                                            options={sortOption}\n                                        />\n                                    </div>\n                                \n                                </div>\n\n\n                                <div id=\"search-result-section\">\n                                    {pets.map((pet) => (\n                                        <Pet pet={pet}/>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    )\n                }\n            </>\n        )\n    }\n}\n\nexport default SearchResult;"]},"metadata":{},"sourceType":"module"}